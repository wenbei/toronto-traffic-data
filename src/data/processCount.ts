import type { CountData } from "src/api/toronto-open-data";

let test = [
  {
    _id: 135254,
    count_id: 6908,
    count_date: "1998-04-22",
    location_id: 3958,
    location: "HIGHWAY 2A AT KINGSTON RD & HIGHWAY 401 EB OFF RAMP (PX 1202)",
    lng: -79.1525300006248,
    lat: 43.7948870036618,
    centreline_type: 2,
    centreline_id: 13503044,
    px: 1202,
    time_start: "1998-04-22T07:30:00",
    time_end: "1998-04-22T07:45:00",
    sb_cars_r: 8,
    sb_cars_t: 44,
    sb_cars_l: 7,
    nb_cars_r: 0,
    nb_cars_t: 1,
    nb_cars_l: 0,
    wb_cars_r: 0,
    wb_cars_t: 160,
    wb_cars_l: 105,
    eb_cars_r: 1,
    eb_cars_t: 98,
    eb_cars_l: 0,
    sb_truck_r: 0,
    sb_truck_t: 0,
    sb_truck_l: 0,
    nb_truck_r: 0,
    nb_truck_t: 0,
    nb_truck_l: 0,
    wb_truck_r: 0,
    wb_truck_t: 1,
    wb_truck_l: 0,
    eb_truck_r: 0,
    eb_truck_t: 2,
    eb_truck_l: 0,
    sb_bus_r: 0,
    sb_bus_t: 0,
    sb_bus_l: 1,
    nb_bus_r: 0,
    nb_bus_t: 0,
    nb_bus_l: 0,
    wb_bus_r: 0,
    wb_bus_t: 0,
    wb_bus_l: 0,
    eb_bus_r: 0,
    eb_bus_t: 0,
    eb_bus_l: 0,
    nx_peds: 0,
    sx_peds: 0,
    ex_peds: 0,
    wx_peds: 0,
    nx_bike: 0,
    sx_bike: 0,
    ex_bike: 0,
    wx_bike: 0,
    nx_other: 0,
    sx_other: 0,
    ex_other: 0,
    wx_other: 0,
  },
  {
    _id: 135255,
    count_id: 6908,
    count_date: "1998-04-22",
    location_id: 3958,
    location: "HIGHWAY 2A AT KINGSTON RD & HIGHWAY 401 EB OFF RAMP (PX 1202)",
    lng: -79.1525300006248,
    lat: 43.7948870036618,
    centreline_type: 2,
    centreline_id: 13503044,
    px: 1202,
    time_start: "1998-04-22T07:45:00",
    time_end: "1998-04-22T08:00:00",
    sb_cars_r: 6,
    sb_cars_t: 19,
    sb_cars_l: 13,
    nb_cars_r: 0,
    nb_cars_t: 1,
    nb_cars_l: 0,
    wb_cars_r: 0,
    wb_cars_t: 161,
    wb_cars_l: 100,
    eb_cars_r: 2,
    eb_cars_t: 129,
    eb_cars_l: 0,
    sb_truck_r: 0,
    sb_truck_t: 0,
    sb_truck_l: 0,
    nb_truck_r: 0,
    nb_truck_t: 0,
    nb_truck_l: 0,
    wb_truck_r: 0,
    wb_truck_t: 1,
    wb_truck_l: 0,
    eb_truck_r: 0,
    eb_truck_t: 10,
    eb_truck_l: 0,
    sb_bus_r: 0,
    sb_bus_t: 0,
    sb_bus_l: 1,
    nb_bus_r: 0,
    nb_bus_t: 0,
    nb_bus_l: 0,
    wb_bus_r: 0,
    wb_bus_t: 0,
    wb_bus_l: 0,
    eb_bus_r: 0,
    eb_bus_t: 2,
    eb_bus_l: 0,
    nx_peds: 0,
    sx_peds: 0,
    ex_peds: 0,
    wx_peds: 0,
    nx_bike: 0,
    sx_bike: 0,
    ex_bike: 0,
    wx_bike: 0,
    nx_other: 0,
    sx_other: 0,
    ex_other: 0,
    wx_other: 0,
  },
  {
    _id: 135256,
    count_id: 6908,
    count_date: "1998-04-22",
    location_id: 3958,
    location: "HIGHWAY 2A AT KINGSTON RD & HIGHWAY 401 EB OFF RAMP (PX 1202)",
    lng: -79.1525300006248,
    lat: 43.7948870036618,
    centreline_type: 2,
    centreline_id: 13503044,
    px: 1202,
    time_start: "1998-04-22T08:00:00",
    time_end: "1998-04-22T08:15:00",
    sb_cars_r: 8,
    sb_cars_t: 0,
    sb_cars_l: 87,
    nb_cars_r: 0,
    nb_cars_t: 0,
    nb_cars_l: 0,
    wb_cars_r: 0,
    wb_cars_t: 167,
    wb_cars_l: 110,
    eb_cars_r: 1,
    eb_cars_t: 55,
    eb_cars_l: 0,
    sb_truck_r: 0,
    sb_truck_t: 0,
    sb_truck_l: 1,
    nb_truck_r: 0,
    nb_truck_t: 0,
    nb_truck_l: 0,
    wb_truck_r: 0,
    wb_truck_t: 2,
    wb_truck_l: 0,
    eb_truck_r: 0,
    eb_truck_t: 4,
    eb_truck_l: 0,
    sb_bus_r: 0,
    sb_bus_t: 0,
    sb_bus_l: 0,
    nb_bus_r: 0,
    nb_bus_t: 0,
    nb_bus_l: 0,
    wb_bus_r: 0,
    wb_bus_t: 0,
    wb_bus_l: 0,
    eb_bus_r: 0,
    eb_bus_t: 0,
    eb_bus_l: 0,
    nx_peds: 2,
    sx_peds: 0,
    ex_peds: 1,
    wx_peds: 1,
    nx_bike: 0,
    sx_bike: 0,
    ex_bike: 1,
    wx_bike: 0,
    nx_other: 0,
    sx_other: 0,
    ex_other: 0,
    wx_other: 0,
  },
  {
    _id: 135257,
    count_id: 6908,
    count_date: "1998-04-22",
    location_id: 3958,
    location: "HIGHWAY 2A AT KINGSTON RD & HIGHWAY 401 EB OFF RAMP (PX 1202)",
    lng: -79.1525300006248,
    lat: 43.7948870036618,
    centreline_type: 2,
    centreline_id: 13503044,
    px: 1202,
    time_start: "1998-04-22T08:15:00",
    time_end: "1998-04-22T08:30:00",
    sb_cars_r: 6,
    sb_cars_t: 2,
    sb_cars_l: 46,
    nb_cars_r: 0,
    nb_cars_t: 0,
    nb_cars_l: 0,
    wb_cars_r: 0,
    wb_cars_t: 176,
    wb_cars_l: 114,
    eb_cars_r: 2,
    eb_cars_t: 50,
    eb_cars_l: 0,
    sb_truck_r: 0,
    sb_truck_t: 0,
    sb_truck_l: 7,
    nb_truck_r: 0,
    nb_truck_t: 0,
    nb_truck_l: 0,
    wb_truck_r: 0,
    wb_truck_t: 3,
    wb_truck_l: 0,
    eb_truck_r: 0,
    eb_truck_t: 3,
    eb_truck_l: 0,
    sb_bus_r: 0,
    sb_bus_t: 0,
    sb_bus_l: 1,
    nb_bus_r: 0,
    nb_bus_t: 0,
    nb_bus_l: 0,
    wb_bus_r: 0,
    wb_bus_t: 0,
    wb_bus_l: 0,
    eb_bus_r: 0,
    eb_bus_t: 1,
    eb_bus_l: 0,
    nx_peds: 6,
    sx_peds: 2,
    ex_peds: 0,
    wx_peds: 1,
    nx_bike: 0,
    sx_bike: 0,
    ex_bike: 0,
    wx_bike: 0,
    nx_other: 0,
    sx_other: 0,
    ex_other: 0,
    wx_other: 0,
  },
  {
    _id: 135258,
    count_id: 6908,
    count_date: "1998-04-22",
    location_id: 3958,
    location: "HIGHWAY 2A AT KINGSTON RD & HIGHWAY 401 EB OFF RAMP (PX 1202)",
    lng: -79.1525300006248,
    lat: 43.7948870036618,
    centreline_type: 2,
    centreline_id: 13503044,
    px: 1202,
    time_start: "1998-04-22T08:30:00",
    time_end: "1998-04-22T08:45:00",
    sb_cars_r: 12,
    sb_cars_t: 6,
    sb_cars_l: 74,
    nb_cars_r: 0,
    nb_cars_t: 0,
    nb_cars_l: 0,
    wb_cars_r: 0,
    wb_cars_t: 157,
    wb_cars_l: 75,
    eb_cars_r: 0,
    eb_cars_t: 41,
    eb_cars_l: 0,
    sb_truck_r: 0,
    sb_truck_t: 0,
    sb_truck_l: 0,
    nb_truck_r: 0,
    nb_truck_t: 0,
    nb_truck_l: 0,
    wb_truck_r: 0,
    wb_truck_t: 0,
    wb_truck_l: 0,
    eb_truck_r: 0,
    eb_truck_t: 3,
    eb_truck_l: 0,
    sb_bus_r: 0,
    sb_bus_t: 0,
    sb_bus_l: 1,
    nb_bus_r: 0,
    nb_bus_t: 0,
    nb_bus_l: 0,
    wb_bus_r: 0,
    wb_bus_t: 0,
    wb_bus_l: 0,
    eb_bus_r: 0,
    eb_bus_t: 1,
    eb_bus_l: 0,
    nx_peds: 4,
    sx_peds: 0,
    ex_peds: 0,
    wx_peds: 0,
    nx_bike: 0,
    sx_bike: 0,
    ex_bike: 0,
    wx_bike: 0,
    nx_other: 0,
    sx_other: 0,
    ex_other: 0,
    wx_other: 0,
  },
  {
    _id: 135259,
    count_id: 6908,
    count_date: "1998-04-22",
    location_id: 3958,
    location: "HIGHWAY 2A AT KINGSTON RD & HIGHWAY 401 EB OFF RAMP (PX 1202)",
    lng: -79.1525300006248,
    lat: 43.7948870036618,
    centreline_type: 2,
    centreline_id: 13503044,
    px: 1202,
    time_start: "1998-04-22T08:45:00",
    time_end: "1998-04-22T09:00:00",
    sb_cars_r: 7,
    sb_cars_t: 7,
    sb_cars_l: 83,
    nb_cars_r: 0,
    nb_cars_t: 0,
    nb_cars_l: 0,
    wb_cars_r: 0,
    wb_cars_t: 113,
    wb_cars_l: 44,
    eb_cars_r: 3,
    eb_cars_t: 52,
    eb_cars_l: 0,
    sb_truck_r: 1,
    sb_truck_t: 0,
    sb_truck_l: 2,
    nb_truck_r: 0,
    nb_truck_t: 0,
    nb_truck_l: 0,
    wb_truck_r: 0,
    wb_truck_t: 1,
    wb_truck_l: 0,
    eb_truck_r: 0,
    eb_truck_t: 2,
    eb_truck_l: 0,
    sb_bus_r: 0,
    sb_bus_t: 0,
    sb_bus_l: 1,
    nb_bus_r: 0,
    nb_bus_t: 0,
    nb_bus_l: 0,
    wb_bus_r: 0,
    wb_bus_t: 1,
    wb_bus_l: 0,
    eb_bus_r: 0,
    eb_bus_t: 1,
    eb_bus_l: 0,
    nx_peds: 5,
    sx_peds: 1,
    ex_peds: 0,
    wx_peds: 1,
    nx_bike: 0,
    sx_bike: 0,
    ex_bike: 1,
    wx_bike: 0,
    nx_other: 0,
    sx_other: 0,
    ex_other: 0,
    wx_other: 0,
  },
  {
    _id: 135260,
    count_id: 6908,
    count_date: "1998-04-22",
    location_id: 3958,
    location: "HIGHWAY 2A AT KINGSTON RD & HIGHWAY 401 EB OFF RAMP (PX 1202)",
    lng: -79.1525300006248,
    lat: 43.7948870036618,
    centreline_type: 2,
    centreline_id: 13503044,
    px: 1202,
    time_start: "1998-04-22T09:00:00",
    time_end: "1998-04-22T09:15:00",
    sb_cars_r: 10,
    sb_cars_t: 3,
    sb_cars_l: 40,
    nb_cars_r: 0,
    nb_cars_t: 0,
    nb_cars_l: 0,
    wb_cars_r: 0,
    wb_cars_t: 89,
    wb_cars_l: 66,
    eb_cars_r: 1,
    eb_cars_t: 46,
    eb_cars_l: 0,
    sb_truck_r: 0,
    sb_truck_t: 0,
    sb_truck_l: 4,
    nb_truck_r: 0,
    nb_truck_t: 0,
    nb_truck_l: 0,
    wb_truck_r: 0,
    wb_truck_t: 2,
    wb_truck_l: 0,
    eb_truck_r: 0,
    eb_truck_t: 1,
    eb_truck_l: 0,
    sb_bus_r: 0,
    sb_bus_t: 0,
    sb_bus_l: 1,
    nb_bus_r: 0,
    nb_bus_t: 0,
    nb_bus_l: 0,
    wb_bus_r: 0,
    wb_bus_t: 0,
    wb_bus_l: 0,
    eb_bus_r: 0,
    eb_bus_t: 0,
    eb_bus_l: 0,
    nx_peds: 3,
    sx_peds: 0,
    ex_peds: 0,
    wx_peds: 0,
    nx_bike: 0,
    sx_bike: 0,
    ex_bike: 0,
    wx_bike: 0,
    nx_other: 0,
    sx_other: 0,
    ex_other: 0,
    wx_other: 0,
  },
  {
    _id: 135261,
    count_id: 6908,
    count_date: "1998-04-22",
    location_id: 3958,
    location: "HIGHWAY 2A AT KINGSTON RD & HIGHWAY 401 EB OFF RAMP (PX 1202)",
    lng: -79.1525300006248,
    lat: 43.7948870036618,
    centreline_type: 2,
    centreline_id: 13503044,
    px: 1202,
    time_start: "1998-04-22T09:15:00",
    time_end: "1998-04-22T09:30:00",
    sb_cars_r: 5,
    sb_cars_t: 4,
    sb_cars_l: 70,
    nb_cars_r: 0,
    nb_cars_t: 2,
    nb_cars_l: 0,
    wb_cars_r: 0,
    wb_cars_t: 81,
    wb_cars_l: 54,
    eb_cars_r: 2,
    eb_cars_t: 41,
    eb_cars_l: 0,
    sb_truck_r: 0,
    sb_truck_t: 0,
    sb_truck_l: 3,
    nb_truck_r: 0,
    nb_truck_t: 0,
    nb_truck_l: 0,
    wb_truck_r: 0,
    wb_truck_t: 2,
    wb_truck_l: 0,
    eb_truck_r: 0,
    eb_truck_t: 2,
    eb_truck_l: 0,
    sb_bus_r: 0,
    sb_bus_t: 0,
    sb_bus_l: 0,
    nb_bus_r: 0,
    nb_bus_t: 0,
    nb_bus_l: 0,
    wb_bus_r: 0,
    wb_bus_t: 0,
    wb_bus_l: 0,
    eb_bus_r: 0,
    eb_bus_t: 1,
    eb_bus_l: 0,
    nx_peds: 3,
    sx_peds: 1,
    ex_peds: 0,
    wx_peds: 0,
    nx_bike: 0,
    sx_bike: 0,
    ex_bike: 0,
    wx_bike: 0,
    nx_other: 0,
    sx_other: 0,
    ex_other: 0,
    wx_other: 0,
  },
  {
    _id: 135262,
    count_id: 6908,
    count_date: "1998-04-22",
    location_id: 3958,
    location: "HIGHWAY 2A AT KINGSTON RD & HIGHWAY 401 EB OFF RAMP (PX 1202)",
    lng: -79.1525300006248,
    lat: 43.7948870036618,
    centreline_type: 2,
    centreline_id: 13503044,
    px: 1202,
    time_start: "1998-04-22T10:00:00",
    time_end: "1998-04-22T10:15:00",
    sb_cars_r: 6,
    sb_cars_t: 7,
    sb_cars_l: 53,
    nb_cars_r: 0,
    nb_cars_t: 0,
    nb_cars_l: 0,
    wb_cars_r: 0,
    wb_cars_t: 59,
    wb_cars_l: 23,
    eb_cars_r: 0,
    eb_cars_t: 43,
    eb_cars_l: 0,
    sb_truck_r: 0,
    sb_truck_t: 1,
    sb_truck_l: 3,
    nb_truck_r: 0,
    nb_truck_t: 0,
    nb_truck_l: 0,
    wb_truck_r: 0,
    wb_truck_t: 1,
    wb_truck_l: 0,
    eb_truck_r: 0,
    eb_truck_t: 2,
    eb_truck_l: 0,
    sb_bus_r: 0,
    sb_bus_t: 0,
    sb_bus_l: 0,
    nb_bus_r: 0,
    nb_bus_t: 0,
    nb_bus_l: 0,
    wb_bus_r: 0,
    wb_bus_t: 0,
    wb_bus_l: 0,
    eb_bus_r: 0,
    eb_bus_t: 0,
    eb_bus_l: 0,
    nx_peds: 5,
    sx_peds: 1,
    ex_peds: 0,
    wx_peds: 0,
    nx_bike: 0,
    sx_bike: 0,
    ex_bike: 0,
    wx_bike: 0,
    nx_other: 0,
    sx_other: 0,
    ex_other: 0,
    wx_other: 0,
  },
  {
    _id: 135263,
    count_id: 6908,
    count_date: "1998-04-22",
    location_id: 3958,
    location: "HIGHWAY 2A AT KINGSTON RD & HIGHWAY 401 EB OFF RAMP (PX 1202)",
    lng: -79.1525300006248,
    lat: 43.7948870036618,
    centreline_type: 2,
    centreline_id: 13503044,
    px: 1202,
    time_start: "1998-04-22T10:15:00",
    time_end: "1998-04-22T10:30:00",
    sb_cars_r: 7,
    sb_cars_t: 6,
    sb_cars_l: 51,
    nb_cars_r: 0,
    nb_cars_t: 0,
    nb_cars_l: 0,
    wb_cars_r: 0,
    wb_cars_t: 69,
    wb_cars_l: 33,
    eb_cars_r: 1,
    eb_cars_t: 54,
    eb_cars_l: 0,
    sb_truck_r: 0,
    sb_truck_t: 0,
    sb_truck_l: 3,
    nb_truck_r: 0,
    nb_truck_t: 0,
    nb_truck_l: 0,
    wb_truck_r: 0,
    wb_truck_t: 6,
    wb_truck_l: 0,
    eb_truck_r: 0,
    eb_truck_t: 4,
    eb_truck_l: 0,
    sb_bus_r: 0,
    sb_bus_t: 0,
    sb_bus_l: 0,
    nb_bus_r: 0,
    nb_bus_t: 0,
    nb_bus_l: 0,
    wb_bus_r: 0,
    wb_bus_t: 0,
    wb_bus_l: 0,
    eb_bus_r: 0,
    eb_bus_t: 1,
    eb_bus_l: 0,
    nx_peds: 4,
    sx_peds: 0,
    ex_peds: 0,
    wx_peds: 0,
    nx_bike: 0,
    sx_bike: 0,
    ex_bike: 0,
    wx_bike: 0,
    nx_other: 0,
    sx_other: 0,
    ex_other: 0,
    wx_other: 0,
  },
];

let data = test[0];

const sumArray = (array: number[]) => {
  return array.reduce((p, c) => p + c, 0);
};

export function getPeakHourData(countDataList: CountData[]) {
  let counts = countDataList.map((i) => {
    return {
      time_start: i.time_start,
      time_end: i.time_end,
      volumes: [
        i.nb_cars_l,
        i.nb_bus_l,
        i.nb_truck_l,
        i.nx_peds,
        i.nx_bike,

        i.sb_cars_l,
        i.sb_bus_l,
        i.sb_truck_l,
        i.sx_peds,
        i.sx_bike,

        i.eb_cars_l,
        i.eb_bus_l,
        i.eb_truck_l,
        i.ex_peds,
        i.ex_bike,

        i.wb_cars_l,
        i.wb_bus_l,
        i.wb_truck_l,
        i.wx_peds,
        i.wx_bike,
      ],
    };
  });
  console.log(counts);

  let intTotal = counts.map((i) => {
    return sumArray(i.volumes);
  });
  console.log(intTotal);

  let sum = [];
  for (let i = 0; i < intTotal.length - 3; i++) {
    const hour = sumArray(intTotal.slice(i, i + 4));
    sum.push(hour);
  }
  console.log("sum", sum);

  let maxHourIndex = sum.indexOf(Math.max(...sum));
  console.log(maxHourIndex);

  let peakHour = counts.slice(maxHourIndex, maxHourIndex + 4);
  console.log(peakHour);

  console.log(sum[maxHourIndex]);
}

const getPHF = (array: number[]) => {
  return sumArray(array) / (4 * Math.max(...array));
};

export function t() {
  getPeakHourData(test);
}
